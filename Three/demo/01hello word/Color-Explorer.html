<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="css/base.css">
    <!--    <link rel="stylesheet" href="../js/jquery/jquery-ui.css">-->
    <!--    <link rel="stylesheet" href="css/info.css">-->
</head>
<body>
<div id="ThreeJs" style="z-index: 1; position: absolute; left:0px; top:0px"></div>
</body>
<script src="../js/three108.js"></script>
<script src="../js/Detector.js"></script>
<script src="../js/Stats.js"></script>
<script src="../js/OrbitControls.js"></script>
<script src="../js/THREEx.KeyborderdState.js"></script>
<script src="../js/THREEx.FullScreen.js"></script>
<script src="../js/THREEx.WindowREsize.js"></script>
<script src="../js/dat.gui.min.js"></script>
<script src="../js/SceneUtils.js"></script>
<!--<script src="../js/jquery/jquery.js"></script>-->
<!--<script src="../js/jquery/jqueryui.js"></script>-->
<!--<script src="../js/info.js"></script>-->
<script>
    var container, scene, camera, renderer, controls, stats;
    var keyboard = new THREEx.KeyboardState();
    var clock = new THREE.Clock();
    var cube;
    init();
    animate();

    function init() {
        // 场景
        scene = new THREE.Scene();
        var SCREEN_WIDTH = window.innerWidth,
            SCREEN_HEIGHT = window.innerHeight;
        var VIEW_ANGLE = 45,
            ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT,
            NEAR = 0.1,
            FAR = 20000;
        // 相机
        camera = new THREE.PerspectiveCamera(VIEW_ANGLE, ASPECT, NEAR, FAR);
        scene.add(camera);
        camera.position.set(0, 150, 400);
        camera.lookAt(0, 0, 0);

        // 渲染器
        if (Detector.webgl) {
            renderer = new THREE.WebGLRenderer({antialias: true});
        } else {
            renderer = new THREE.CanvasRenderer();
        }
        renderer.setSize(SCREEN_WIDTH, SCREEN_HEIGHT);
        // 容器
        container = document.getElementById('ThreeJs');
        container.appendChild(renderer.domElement);

        THREEx.WindowResize(renderer, camera);
        THREEx.FullScreen.bindKey({
            charCode: 'm'.charCodeAt(0)
        });

        controls = new THREE.OrbitControls(camera, renderer.domElement);


        // 性能分析
        stats = new Stats();
        stats.domElement.style.position = 'absolute';
        stats.domElement.style.bottom = '0px';
        stats.domElement.style.zIndex = 100;
        container.appendChild(stats.domElement);

        //灯光
        var light = new THREE.PointLight(0xffffff);
        light.position.set(-100, 150, 100);


        var light2 = new THREE.AmbientLight(0x333333);
        light2.position.set(-100,150,100);
        scene.add(light2);

        var lightbulbGeometry = new THREE.SphereGeometry(10,16,8);
        var lightbulbMaterial = new THREE.MeshBasicMaterial({color:0xffffff,transparent: true,  opacity: 0.8, blending: THREE.AdditiveBlending});
        var writeMaterial = new THREE.MeshBasicMaterial({color: 0x000000, wireframe: true });
        var materialArray = [lightbulbMaterial,writeMaterial];
        var lightbulb = THREE.SceneUtils.createMultiMaterialObject(lightbulbGeometry,materialArray);
        lightbulb.position.set(-100,150,100);
        scene.add(lightbulb);
        scene.add(light);
        // 地面
        // var floorTexture = new THREE.ImageUtils.loadTexture('../images/checkerboard.jpg');
        var floorTexture = new THREE.ImageUtils.loadTexture('../images/checkerboard.jpg');
        floorTexture.wrapS = floorTexture.wrapT = THREE.RepeatWrapping;
        floorTexture.repeat.set(10, 10);


        var floorMaterial = new THREE.MeshBasicMaterial({
            map: floorTexture,
            side: THREE.DoubleSide
        });
        var floorGeometry = new THREE.PlaneGeometry(1000, 1000, 10, 10);
        var floor = new THREE.Mesh(floorGeometry, floorMaterial);
        floor.position.y = -0.5;
        floor.rotation.x = Math.PI / 2;
        scene.add(floor);

        //天空
        var skyGeometry = new THREE.CubeGeometry(10000, 10000, 10000);
        var skyMaterial = new THREE.MeshBasicMaterial({
            color: 0x9999ff,
            side: THREE.BackSide
        });
        var skyBox = new THREE.Mesh(skyGeometry, skyMaterial);
        scene.add(skyBox);
        // scene.fog = new THREE.FogExp2( 0x9999ff, 0.00025 );

        var sphereGeometry = new THREE.SphereGeometry(60,50,50);
        var darkMaterial = new THREE.MeshBasicMaterial({color:0xff0000, transparent:true, opacity:1});

        sphere = new THREE.Mesh(sphereGeometry.clone(),darkMaterial);
        sphere.position.set(0,60,0);
        scene.add(sphere);
        var axes = new THREE.AxisHelper(10000);
        scene.add(axes);

        gui = new dat.GUI();
        parameters = {
            x:0,
            y:60,
            z:0,
            color:'#ff0000',
            colorA:'#000000',
            colorE:'#000033',
            colorS:'#ffff00',
            shininess:30,
            opacity:1,
            visible:true,
            material:'Phong',
            reset:function () {
                resetSphere()
            }
        };
        // console.log(gui)
        // gui.addColor(parameters, "x").name("x").onChange(function (e) {
        // });
        container.appendChild(gui.domElement)
        var folder1 = gui.addFolder('Position');
        var sphereX = folder1.add( parameters, 'x' ).min(-200).max(200).step(1).listen();
        var sphereY = folder1.add( parameters, 'y' ).min(0).max(100).step(1).listen();
        var sphereZ = folder1.add( parameters, 'z' ).min(-200).max(200).step(1).listen();
        folder1.open();

        sphereX.onChange(function(value)
        {   sphere.position.x = value;   });
        sphereY.onChange(function(value)
        {   sphere.position.y = value;   });
        sphereZ.onChange(function(value)
        {   sphere.position.z = value;   });

        var sphereColor = gui.addColor( parameters, 'color' ).name('Color (Diffuse)').listen();
        sphereColor.onChange(function(value) // onFinishChange
        {   sphere.material.color.setHex( value.replace("#", "0x") );   });
        var sphereColorA = gui.addColor( parameters, 'colorA' ).name('Color (Ambient)').listen();
        sphereColorA.onChange(function(value) // onFinishChange
        {   sphere.material.ambient.setHex( value.replace("#", "0x") );   });
        var sphereColorE = gui.addColor( parameters, 'colorE' ).name('Color (Emissive)').listen();
        sphereColorE.onChange(function(value) // onFinishChange
        {   sphere.material.emissive.setHex( value.replace("#", "0x") );   });
        var sphereColorS = gui.addColor( parameters, 'colorS' ).name('Color (Specular)').listen();
        sphereColorS.onChange(function(value) // onFinishChange
        {   sphere.material.specular.setHex( value.replace("#", "0x") );   });
        var sphereShininess = gui.add( parameters, 'shininess' ).min(0).max(60).step(1).name('Shininess').listen();
        sphereShininess.onChange(function(value)
        {   sphere.material.shininess = value;   });
        var sphereOpacity = gui.add( parameters, 'opacity' ).min(0).max(1).step(0.01).name('Opacity').listen();
        sphereOpacity.onChange(function(value)
        {   sphere.material.opacity = value;   });

        var sphereMaterial = gui.add( parameters, 'material', [ "Basic", "Lambert", "Phong", "Wireframe" ] ).name('Material Type').listen();
        sphereMaterial.onChange(function(value)
        {   updateSphere();   });

        gui.add( parameters, 'reset' ).name("Reset Sphere Parameters");
    }
    function updateSphere()
    {
        var value = parameters.material;
        var newMaterial;
        if (value == "Basic")
            newMaterial = new THREE.MeshBasicMaterial( { color: 0x000000 } );
        else if (value == "Lambert")
            newMaterial = new THREE.MeshLambertMaterial( { color: 0x000000 } );
        else if (value == "Phong")
            newMaterial = new THREE.MeshPhongMaterial( { color: 0x000000 } );
        else // (value == "Wireframe")
            newMaterial = new THREE.MeshBasicMaterial( { wireframe: true } );
        sphere.material = newMaterial;

        sphere.position.x = parameters.x;
        sphere.position.y = parameters.y;
        sphere.position.z = parameters.z;
        sphere.material.color.setHex( parameters.color.replace("#", "0x") );
        if (sphere.material.ambient)
            sphere.material.ambient.setHex( parameters.colorA.replace("#", "0x") );
        if (sphere.material.emissive)
            sphere.material.emissive.setHex( parameters.colorE.replace("#", "0x") );
        if (sphere.material.specular)
            sphere.material.specular.setHex( parameters.colorS.replace("#", "0x") );
        if (sphere.material.shininess)
            sphere.material.shininess = parameters.shininess;
        sphere.material.opacity = parameters.opacity;
        sphere.material.transparent = true;

    }
    function animate() {
        requestAnimationFrame(animate);
        render();
        update();
    }

    function update() {
        if ( keyboard.pressed("z") )
        {
            // do something
        }

        controls.update();
        stats.update();
    }
    function resetSphere()
    {
        parameters.x = 0;
        parameters.y = 60;
        parameters.z = 0;
        parameters.color = "#ff0000";
        parameters.colorA = "#000000";
        parameters.colorE = "#000033";
        parameters.colorS = "#ffff00";
        parameters.shininess = 30;
        parameters.opacity = 1;
        parameters.visible = true;
        parameters.material = "Phong";
        updateSphere();
    }
    function render() {
        renderer.render(scene, camera);
    }
</script>
</html>